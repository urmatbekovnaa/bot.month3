!function(){var e={4846:function(e,t,r){e.exports=r(8544)},8544:function(e,t){"use strict";var r=function(){function e(){}return e.isError=function(e){return"ProtocolError"===e.status||"InternalServerError"===e.status},e.isValidationError=function(e){return"ValidationError"===e.status},e.isSuccess=function(e){return"Success"===e.status},e}();t.ServiceResponses=r},4316:function(e,t){"use strict";t.__esModule=!0;var r=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();t.Guid=r},1421:function(){
// Console-polyfill. MIT license.
!function(e){"use strict";e.console=e.console||{};for(var t,r,n=e.console,o={},i=function(){},a="memory".split(","),s="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=a.pop();)n[t]||(n[t]=o);for(;r=s.pop();)n[r]||(n[r]=i)}("undefined"==typeof window?this:window)},4304:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var n=r(1616),o=function(){function e(e){var t=this;if(this.logExceptionInternal=function(e,r){t.logger.trackException(e,r)},this.logAndThrowExceptionInternal=function(e,r){throw t.logger.trackException(e,r),e},this.logEvent=function(e,r,n){t.logger.trackEvent(e,r,n)},null==e)throw new Error("'logger' cannot be null");this.logger=e}return e.create=function(t){if(null==t)throw new Error("'loggerProvider' cannot be null");self.LogManager=new e(t())},e.LogException=function(t,r){e.getOrCreateInstance().logExceptionInternal(t,r)},e.LogAndThrowException=function(t,r){e.getOrCreateInstance().logAndThrowExceptionInternal(t,r)},e.LogEvent=function(t,r,n){e.getOrCreateInstance().logEvent(t,r,n)},e.selectProvider=function(){return new n.LoggerStub},e.getOrCreateInstance=function(){var t=self;return null==t.LogManager&&(console.warn("LogManager was not instantiated before (in entry file). Using dummy."),t.LogManager=new e(e.selectProvider())),t.LogManager},e}();t.Logger=o},1616:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStub=void 0;var r=function(){function e(){}return e.prototype.trackException=function(e){},e.prototype.trackEvent=function(e){},e}();t.LoggerStub=r},8397:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.loadModule=t.moduleExists=t.getModuleInfo=t.initializeModule=void 0;var o=r(6e3),i=r(6454);r(2573);var a,s=r(7838),u=r(5464);!function(e){e.NotLoaded="NotLoaded",e.Loading="Loading",e.Loaded="Loaded",e.Failed="Failed"}(a||(a={}));t.initializeModule=function(e){return{moduleInfo:e,loadingState:a.NotLoaded,loadingPromise:null,loadingError:null}};var c=((n={})[u.webpushModuleInfo.name]=(0,t.initializeModule)(u.webpushModuleInfo),n[s.webpushV2ModuleInfo.name]=(0,t.initializeModule)(s.webpushV2ModuleInfo),n),l=function(e){var t=c[e];if(null==t)throw new Error("[Mindbox.SDK] <core> Module ".concat(e," is not registered."));return t};t.getModuleInfo=function(e){return l(e).moduleInfo};t.moduleExists=function(e){return e in c};t.loadModule=function(e,t,r,n){var s=l(t);switch(s.loadingState){case a.Loaded:return Promise.resolve(p(s.moduleInfo));case a.Loading:return s.loadingPromise;case a.NotLoaded:return s.loadingState=a.Loading,s.loadingPromise=new Promise((function(u,c){var l=document.createElement("script");l.src="".concat((0,o.getScriptsRoot)(e),"/scripts/modules/").concat(i.targetModern?s.moduleInfo.modernSrc:s.moduleInfo.src,"?version=").concat(r),l.async=!0;var f=function(){return null==d(s.moduleInfo)},h=function(){try{s.loadingState=a.Loaded,u(p(s.moduleInfo))}catch(e){s.loadingState=a.Failed,s.loadingError=e,c(e)}},g={"Module name":s.moduleInfo.name};l.onload=function(){f()?(n.trackEvent("Loading module in another loop",g),setTimeout((function(){f()?n.trackEvent("Couldn't load module in another loop",g):n.trackEvent("Have loaded module in another loop",g),h()}),5e3)):h()},l.onerror=function(){c(new Error("[Mindbox.SDK] <core> There was an error during loading of '".concat(t,"' module")))};try{document.head.insertAdjacentElement("beforeend",l)}catch(e){c(e)}})),s.loadingPromise;case a.Failed:return s.loadingPromise;default:throw new Error("[Mindbox.SDK] <core> Unknown module loading state ".concat(s.loadingState,"."))}};var d=function(e){return window.mindbox[e.name]},p=function(e){var t=d(e);if(null==t)throw new Error("[Mindbox.SDK] <core> Expected module not found in mindbox[".concat(e.name,"]"));return t}},5450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDebugHelper=t.webpushModuleInfo=void 0;var n=r(1635),o=r(7838),i=r(3217),a=r(8986),s=function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(r){switch(r.label){case 0:return window&&window.navigator&&window.navigator.serviceWorker?(e=function(e){return e.installing||e.waiting||e.active},[4,window.navigator.serviceWorker.getRegistrations().then((function(t){return t.find((function(t){var r=e(t);return a.workerPathHelper.isPathMatched(r.scriptURL)}))}))]):[3,2];case 1:return[2,(t=r.sent())&&e(t)];case 2:return[2,null]}}))}))};t.webpushModuleInfo={name:"webpush",src:"webpush.js",modernSrc:"webpush.modern.js",version:"1.19.83",isSupportedByBrowser:function(){return navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")&&("https:"==window.location.protocol||["localhost","127.0.0.1",""].some((function(e){return e===window.location.hostname})))},requiresSdkInitialization:function(){return!0},getModuleNameToReplace:function(e,r){return void 0===r&&(r={getWebpushServiceWorker:s}),n.__awaiter(void 0,void 0,void 0,(function(){var a;return n.__generator(this,(function(n){switch(n.label){case 0:return e?e.firebaseMessagingSettings?[2,o.webpushV2ModuleInfo.name]:[3,3]:[3,1];case 1:return[4,r.getWebpushServiceWorker()];case 2:if((a=n.sent())&&a.scriptURL.indexOf(i.WEBPUSH_V2_PREFIX)>-1)return[2,o.webpushV2ModuleInfo.name];n.label=3;case 3:return[2,t.webpushModuleInfo.name]}}))}))}};t.addDebugHelper=function(e,t){var r="__mindboxDebugHelpers",n=window[r];null==n&&(window[r]=n={});var o="webpush",i=n[o];null==i&&(n[o]=i={}),null!=i[e]||(i[e]=t)}},5464:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDebugHelper=t.webpushModuleInfo=void 0;var n=r(5450);Object.defineProperty(t,"webpushModuleInfo",{enumerable:!0,get:function(){return n.webpushModuleInfo}}),Object.defineProperty(t,"addDebugHelper",{enumerable:!0,get:function(){return n.addDebugHelper}})},7838:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDebugHelper=t.webpushV2ModuleInfo=void 0;t.webpushV2ModuleInfo={name:"webpush_v2",src:"webpush_v2.js",modernSrc:"webpush_v2.js",version:"1.19.83",isSupportedByBrowser:function(){return navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")&&("https:"==window.location.protocol||["localhost","127.0.0.1",""].some((function(e){return e===window.location.hostname})))},requiresSdkInitialization:function(){return!0}};t.addDebugHelper=function(e,t){var r="__mindboxDebugHelpers",n=window[r];null==n&&(window[r]=n={});var o="webpush_v2",i=n[o];null==i&&(n[o]=i={}),null!=i[e]||(i[e]=t)}},9574:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.featuresShortName=void 0;var o=r(2573);t.featuresShortName=((n={})[o.Feature.UseWebpushErrorLogging]="f_el",n[o.Feature.UseWebpushFirebaseInitializationLogging]="f_fil",n)},8986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerPathHelper=void 0;var n=r(3049);Object.defineProperty(t,"workerPathHelper",{enumerable:!0,get:function(){return n.workerPathHelper}})},3049:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerPathHelper=void 0;var n=r(2573),o=r(9574),i=function(){function e(){}return e.prototype.checkVersion=function(t){if(new RegExp(e.versionRegExpString).test(t))return!0;throw new Error("incorrect module version: ".concat(t,', should be like "1.1.1"'))},e.prototype.getFullPath=function(t){var r=t.path,i=void 0===r?e.defaultServiceWorkerPath:r,a=t.moduleVersion,s=t.firebaseMessagingSettings,u=t.features;this.checkVersion(a);var c="".concat(e.versionParamName,"=").concat(a);return i+"?"+[new URLSearchParams(s).toString(),"".concat(o.featuresShortName[n.Feature.UseWebpushErrorLogging],"=").concat(Boolean(u.useWebpushErrorLogging)),"".concat(o.featuresShortName[n.Feature.UseWebpushFirebaseInitializationLogging],"=").concat(Boolean(u.useWebpushFirebaseInitializationLogging)),c].join("&")},e.prototype.isPathMatched=function(t){return new RegExp(".+?".concat(e.messagingSenderIdParamName,"=.+&").concat(e.versionParamName,"=").concat(e.versionRegExpString)).test(t)},e.messagingSenderIdParamName="messagingSenderId",e.versionParamName="version",e.defaultServiceWorkerPath="/mindbox-services-worker.js",e.versionRegExpString="\\d+\\.\\d+\\.\\d+",e}();t.workerPathHelper=new i},3217:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WEBPUSH_V2_PREFIX=void 0,t.WEBPUSH_V2_PREFIX="webpushV2"},9495:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseWithRetries=void 0;var n=r(1635),o={retries:2,startDelay:100,delayRate:1},i=function(){function e(e,t){void 0===t&&(t={}),this.isCancelled=!1,this.getPromise=e,this.options=n.__assign(n.__assign({},o),t)}return e.prototype.execute=function(){return n.__awaiter(this,void 0,Promise,(function(){var e=this;return n.__generator(this,(function(t){return[2,new Promise((function(t,r){return n.__awaiter(e,void 0,void 0,(function(){var e,o,i,a=this;return n.__generator(this,(function(s){return e=this.options.retries,o=null,i=function(s){return n.__awaiter(a,void 0,void 0,(function(){var a,u,c=this;return n.__generator(this,(function(n){switch(n.label){case 0:if(this.isCancelled)return t(null),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.getPromise()];case 2:return a=n.sent(),t(a),[2];case 3:return u=n.sent(),o=u,0===e?(r(o),[2]):(e--,[3,4]);case 4:return setTimeout((function(){var e=s*c.options.delayRate;i(e)}),s),[2]}}))}))},[2,i(this.options.startDelay)]}))}))}))]}))}))},e.prototype.cancel=function(){this.isCancelled=!0},e}();t.PromiseWithRetries=i},3652:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseWithRetries=void 0;var n=r(9495);Object.defineProperty(t,"PromiseWithRetries",{enumerable:!0,get:function(){return n.PromiseWithRetries}})},666:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BatchedModulesLoader=void 0;var n=r(1635),o=r(6e3),i=r(3931),a=r(7775),s=r(3652),u=36e5,c=3e5,l=function(){function e(e){this.jsModulesClient=e}return e.prototype.loadModule=function(e,t){var r=this;return new Promise((function(o,i){return n.__awaiter(r,void 0,void 0,(function(){var r,a,s,u;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),(r=document.createElement("script")).type="text/javascript",[4,this.getBlob(e,t)];case 1:return a=n.sent(),s=r,[4,a.text()];case 2:return s.text=n.sent(),document.getElementsByTagName("head")[0].appendChild(r),o(),[3,4];case 3:return u=n.sent(),i(u),[3,4];case 4:return[2]}}))}))}))},e.prototype.getBlob=function(e,t){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(r){return null!=e.endpointId?[2,this.getBlobByEndpointId(e)]:[2,this.getBlobByHost(e,t)]}))}))},e.prototype.getBlobByEndpointId=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r,i,a,s,l=this;return n.__generator(this,(function(n){return t="js/byendpoint/".concat(e.endpointId.toLowerCase(),".js"),r=(0,o.getStaticAssetsRoot)(e),i=(0,o.getScriptsRoot)(e),a=this.getBlobUrl(r,t,c),s=this.getBlobUrl(i,t,u),r===i?[2,this.getBlobByUrl(s).catch((function(e){throw new Error(e)}))]:[2,this.getBlobByUrl(a).catch((function(e){return l.getBlobByUrl(s).catch((function(t){throw new Error("".concat(e,"; ").concat(t))}))}))]}))}))},e.prototype.getBlobByHost=function(e,t){return n.__awaiter(this,void 0,Promise,(function(){var r,a,s,l,d,p=this;return n.__generator(this,(function(n){return r=(0,i.getDomainsByHost)(t),a=(0,o.getStaticAssetsRoot)(e),s=(0,o.getScriptsRoot)(e),l=r.map((function(e){return p.getBlobUrl(a,"js/bydomain/".concat(e.toLowerCase(),".js"),c)})),d=r.map((function(e){return p.getBlobUrl(s,"js/bydomain/".concat(e.toLowerCase(),".js"),u)})),a===s?[2,this.getBlobByChain(d).catch((function(e){throw new Error(e)}))]:[2,this.getBlobByChain(l).catch((function(e){return p.getBlobByChain(d).catch((function(t){throw new Error("".concat(e,"; ").concat(t))}))}))]}))}))},e.prototype.getBlobByUrl=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r=this;return n.__generator(this,(function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new s.PromiseWithRetries((function(){return r.jsModulesClient.getRemoteBlob(e)})).execute()];case 2:return t=n.sent(),[3,4];case 3:throw n.sent(),"Blob failed by url ".concat(e);case 4:if(!t)throw"Blob not found by url ".concat(e);return[2,t]}}))}))},e.prototype.getBlobByChain=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r,o=this;return n.__generator(this,(function(n){switch(n.label){case 0:return t=e.map((function(e){return o.jsModulesClient.getRemoteBlob(e)})),[4,(0,a.runPrioritizedChain)(t)];case 1:if((r=n.sent()).every((function(e){return e.lastError})))throw"Blobs failed by urls: ".concat(e.join(", "));if(r.every((function(e){return!e.lastResult})))throw"Blobs not found by urls: ".concat(e.join(", "));return[2,r.find((function(e){return e&&e.lastResult})).lastResult]}}))}))},e.prototype.getBlobUrl=function(e,t,r){var n=new URLSearchParams(window.location.search),o=Date.now(),i="true"==n.get("mindbox_nocache")?Math.floor(o/1e3):Math.floor(o/r);return"".concat(e,"/").concat(t,"?_=").concat(i)},e}();t.BatchedModulesLoader=l},3931:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainsByHost=void 0;t.getDomainsByHost=function(e){var t=e.split("."),r=[];if(t.length>1){r.push(e);for(var n=1;n<t.length-1;n++){var o="*."+t.slice(n,t.length).join(".");r.push(o)}}return r}},7732:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsModulesClientStub=t.jsModulesClient=void 0;var n=r(1635),o=function(){function e(){}return e.prototype.getRemoteBlob=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,fetch(e)];case 1:switch(t=r.sent(),!0,!0){case 200==t.status:return[3,2];case 204==t.status:case 322==t.status:case t.status>=400&&t.status<=499:return[3,4]}return[3,5];case 2:return[4,t.blob()];case 3:return[2,r.sent()];case 4:return[2,null];case 5:case 6:throw new Error(t.statusText)}}))}))},e}(),i=function(){function e(){this.responses=new Map,this.invokedRequests=new Array,this.errors=new Map,this.invokedErrors=new Array,this.defaultResponse=null,this.defaultError=new Error("Something went wrong")}return e.prototype.getRemoteBlob=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t=this;return n.__generator(this,(function(r){return[2,new Promise((function(r,n){if(t.errors.has(e))return t.invokedErrors.push(e),n(t.errors.get(e));var o={response:t.defaultResponse,timeout:0};t.responses.has(e)&&(t.invokedRequests.push(e),o=t.responses.get(e)),o.instant?r(o.response):setTimeout((function(){o.onBeforeResolve&&o.onBeforeResolve(),r(o.response)}),o.timeout)}))]}))}))},e.prototype.setResponse=function(e,t,r){var n=void 0===r?{timeout:0}:r,o=n.timeout,i=void 0===o?0:o,a=n.instant,s=n.onBeforeResolve;this.responses.set(e,{response:t,timeout:i,instant:a,onBeforeResolve:s})},e.prototype.setError=function(e,t){void 0===t&&(t=null),null==t&&(t=this.defaultError),this.errors.set(e,t)},e.prototype.flush=function(){this.responses.clear(),this.errors.clear()},e.prototype.invokedRequest=function(e,t){return t==this.invokedRequests.filter((function(t){return t==e})).length},e.prototype.invokedError=function(e,t){return t==this.invokedErrors.filter((function(t){return t==e})).length},e}();t.JsModulesClientStub=i;var a=new o;t.jsModulesClient=a},7775:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runPrioritizedChain=void 0;var n=r(1635),o=r(3652);t.runPrioritizedChain=function(e){return n.__awaiter(void 0,void 0,Promise,(function(){var t,r;return n.__generator(this,(function(i){return t=e.map((function(e){return new o.PromiseWithRetries((function(){return e}))})),r=t.map((function(e,r){return n.__awaiter(void 0,void 0,void 0,(function(){var o,i;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.execute()];case 1:return o=n.sent(),i=t[r+1],o&&i&&i.cancel(),[2,{lastResult:o,lastError:null}];case 2:return[2,{lastResult:null,lastError:n.sent()}];case 3:return[2]}}))}))})),[2,Promise.all(r)]}))}))}},9204:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Format=t.Manager=void 0;var r,n=function(){function e(e,t,r,n){this._pluses=/\+/g,this.MaxCookieExpirationDate=new Date(2038,1,19),this._navigator=e?e.navigator:navigator,this._document=e?e.document:document,this._domain=t,this._path=r,this._secure=n}return e.prototype.remove=function(e,t){return null!=this.tryGet(e,r.Raw)&&(this.set(e,"",-1,r.Raw,t),!this.tryGet(e,r.Raw))},e.prototype.tryGetJson=function(e){return this.tryGet(e,r.Json)},e.prototype.tryGet=function(e,t){var n=null;void 0===t&&(t=r.String);for(var o=this._document.cookie,i=o?o.split("; "):[],a=0,s=i.length;a<s;a++){var u=i[a].split("="),c=this.decode(u.shift(),t),l=u.join("=");if(e===c){n=this.read(l,t);break}}return n},e.prototype.setJson=function(e,t,n){return this.set(e,t,n,r.Json)},e.prototype.set=function(e,t,n,o,i){void 0===o&&(o=r.String),-1!==n&&this.remove(e);var a=null;null!=n&&"number"==typeof n?(a=new Date).setTime(+a+864e5*n):null!=n&&n instanceof Date&&(a=n);var s=null==i?this._domain:i;return s===this._document.domain&&(s=null),this._document.cookie=[this.encode(e,o),"=",this.stringifyCookieValue(t,o),null!=a?"; expires="+a.toUTCString():"","; path="+(null!=this._path?this._path:"/"),s?"; domain="+s:"",null!=this._secure&&this._secure?"; secure":""].join("")},e.prototype.removeAcrossBaseDomain=function(e){var t=this.getBaseDomain();if(t)for(var r=this._document.domain.split("."),n=t.substring(1).split("."),o=r.length-n.length+1-1;o>=0;o--){var i="."+r.slice(o).join(".");this.remove(e,i)}this.remove(e,this._document.domain)},e.prototype.isCookieEnabled=function(){try{if(this.isInternetExplorer()){this._document.cookie="testcookie=testcookie";var e=-1!==this._document.cookie.indexOf("testcookie=testcookie");return this.remove("testcookie"),e}e=!!this._navigator.cookieEnabled;return void 0!==this._navigator.cookieEnabled||e||(this._document.cookie="testcookie=testcookie",e=-1!==this._document.cookie.indexOf("testcookie=testcookie"),this.remove("testcookie")),e}catch(e){return!1}},e.prototype.isInternetExplorer=function(){var e=this._navigator.userAgent;if(void 0===e)return!1;var t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e.prototype.read=function(e,t){t!=r.Raw&&t!=r.String||0!==e.indexOf('"')||(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{switch(e=t==r.Raw?e:decodeURIComponent(e.replace(this._pluses," ")),t){case r.Raw:case r.String:return e;case r.Json:return JSON.parse(e);default:throw new Error("Unknown format")}}catch(e){}},e.prototype.encode=function(e,t){switch(t){case r.Raw:return e;case r.Json:case r.String:return encodeURIComponent(e);default:throw new Error("Unknown format")}},e.prototype.decode=function(e,t){switch(t){case r.Raw:return e;case r.Json:case r.String:return decodeURIComponent(e);default:throw new Error("Unknown format")}},e.prototype.stringifyCookieValue=function(e,t){switch(t){case r.Raw:case r.String:return this.encode(String(e),t);case r.Json:return this.encode(JSON.stringify(e),t);default:throw new Error("Unknown format")}},e.prototype.setBaseDomain=function(){this._domain=this.getBaseDomain()},e.prototype.getBaseDomain=function(){return this._baseDomain||(this._baseDomain=this.computeBaseDomain()),this._baseDomain},e.prototype.computeBaseDomain=function(){if(!this.isCookieEnabled())return null;for(var e=this._document.domain?"."+this._document.domain:"",t=e.length-1;;){if(t<=0)return null;for(;t>=0&&"."!==e[t];)t--;var r=e.substr(t);if(this._document.cookie="domaintest=value; path=/; domain="+r,-1!==this._document.cookie.indexOf("domaintest=value"))return this._document.cookie="domaintest=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; domain="+r,r;t--}},e}();t.Manager=n,function(e){e[e.Json=0]="Json",e[e.String=1]="String",e[e.Raw=2]="Raw"}(r=t.Format||(t.Format={}))},8054:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CrossDomainRequestFactory=void 0;var n=r(4846),o=r(3129),i=r(2744),a=r(4869);t.CrossDomainRequestFactory=function(e,t,r,n){return new s(e,t,r,n)};var s=function(){function e(e,t,r,n){this.timeout=6e4,this._httpMethod=e,this._url=t,this._payload=i.PayloadSerializer.serialize(r),this._essentialQueryStringParameters=i.PayloadSerializer.serialize(n)}return e.prototype.sendAndGetResult=function(){var e=this.sendViaXmlHttpRequest()||this.sendViaJsonp();if(null==e)throw new Error("Browser doesn't support big cross domain requests.");return e},e.prototype.sendAndForget=function(){var e=this.sendViaBeacon()||this.sendViaImage()||this.sendViaXmlHttpRequest();if(null==e)throw new Error("Browser doesn't support big cross domain requests.");return e},e.prototype.sendViaBeacon=function(){var t=e.appendQueryString(this._url,"transport=beacon");this._essentialQueryStringParameters&&(t=e.appendQueryString(t,this._essentialQueryStringParameters));try{return void 0!==navigator.sendBeacon&&navigator.sendBeacon(t,this._payload)?Promise.resolve():null}catch(e){return null}},e.prototype.sendViaImage=function(){var t=this,r=e.appendQueryString(this._url,"transport=image&"+this._payload);if(r.length>e.maxUrlLength)return null;var n=document.createElement("img");n.width=1,n.height=1,n.src=r;var o=new Promise((function(e,t){n.onload=n.onerror=function(t){n.onload=null,n.onerror=null,e()}})),i=new Promise((function(e,r){setTimeout((function(){return r(new a.Timeout("Timeout in sendViaImage."))}),t.timeout)}));return Promise.race([o,i])},e.prototype.sendViaJsonp=function(){var t=this,r="Mindbox_jsonp_"+e.jsonpRequestNumber++,o=r+"resolve",i=e.appendQueryString(this._url,"transport=jsonp&"+this._payload+'&jsonpCallback=window["'+r+'"]');if(i.length>e.maxUrlLength)return null;var s=document.createElement("script");s.type="text/javascript",s.src=i;var u=new Promise((function(e){window[o]=e,window[r]=function(e){try{window[o](e)}finally{document.getElementsByTagName("head")[0].removeChild(s),s=null;try{delete window[r],delete window[o]}catch(e){window[r]=void 0,window[o]=void 0}}}}));document.getElementsByTagName("head")[0].appendChild(s);var c=new Promise((function(e,r){setTimeout((function(){r(new a.Timeout("Timeout in sendViaJsonp."))}),t.timeout)}));return u=u.then((function(e){if(n.ServiceResponses.isError(e))throw new a.HttpError(e.httpStatusCode,e.errorMessage);return e})),Promise.race([u,c])},e.prototype.sendViaXmlHttpRequest=function(){if("undefined"==typeof XMLHttpRequest)return null;var t=new XMLHttpRequest;if(!("withCredentials"in t))return null;var r=e.appendQueryString(this._url,"transport=XmlHttpRequest");this._httpMethod==o.HttpMethods.GET?r=e.appendQueryString(r,this._payload):this._essentialQueryStringParameters&&(r=e.appendQueryString(r,this._essentialQueryStringParameters)),t.open(this._httpMethod,r,!0),t.withCredentials=!0,t.timeout=this.timeout,t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var i=new Promise((function(e,r){t.onreadystatechange=function(){if(4==t.readyState)if(t.status>=200&&t.status<300)e(JSON.parse(t.responseText));else if(0==t.status)r(new a.Timeout("Timeout in sendViaXmlHttpRequest."));else{var o=void 0,i=void 0;try{var s=JSON.parse(t.responseText);n.ServiceResponses.isError(s)&&(o=s.errorMessage);var u=s;u.requestId&&(i=u.requestId)}catch(e){}r(new a.HttpError(t.status,o||t.responseText,i))}}}));return this._httpMethod==o.HttpMethods.GET?t.send():t.send(this._payload),i},e.appendQueryString=function(e,t){return e+(e.match(/\?/)?"&":"?")+t},e.maxUrlLength=2036,e.jsonpRequestNumber=0,e}()},3129:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMethods=void 0;var r=function(){function e(){}return e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e}();t.HttpMethods=r},5980:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomerSessionStorage=void 0;var n=r(4316),o="directCrm-session",i=function(){function e(e){var t=e.cookieManager,r=e.windowOverride,n=e.deviceUUIDVarName,o=e.migrationDeviceUUIDVarName,i=e.isMigrationRequired,a=e.logger,s=this;this.isDeviceUUIDCompletelySetOrSyncedResolve=function(){},this._window=r||window,this._cookieManager=t,this.deviceUUIDVarName=n,this.migrationDeviceUUIDVarName=o,this.isMigrationRequired=i,this.logger=a,this.syncMigrationVarNames(),this.isDeviceUUIDCompletelySetOrSynced=new Promise((function(e){try{if(s.isDeviceUUIDCompletelySet())return e()}catch(t){return s.logger.logError(t),e()}s.isDeviceUUIDCompletelySetOrSyncedResolve=e}))}return e.prototype.syncMigrationVarNames=function(){if(this.migrationDeviceUUIDVarName&&this.migrationDeviceUUIDVarName!==this.deviceUUIDVarName){var e=this.tryGetDeviceUUIDByVarName(this.migrationDeviceUUIDVarName),t=this.tryGetDeviceUUIDByVarName(this.deviceUUIDVarName);e?this.setDeviceUUID(e):this.isMigrationRequired&&t&&this.setMigrationDeviceUUID(t)}},e.prototype.setSession=function(e){var t=new Date,r=new Date(t.getFullYear()+2,t.getMonth(),t.getDate());this._cookieManager.removeAcrossBaseDomain(o),this._cookieManager.setJson(o,e,r);try{this._window.localStorage[o]=JSON.stringify(e)}catch(e){}},e.prototype.getDeviceUUID=function(){var e=this.tryGetDeviceUUID();if(null==e)throw new Error("DeviceUUID not set");return e},e.prototype.tryGetDeviceUUID=function(){return this.tryGetDeviceUUIDByVarName(this.deviceUUIDVarName)},e.prototype.tryGetDeviceUUIDByVarName=function(e){return this.tryGetDeviceUUIDFromLocalStorageByVarName(e)||this._cookieManager.tryGet(e)},e.prototype.tryGetDeviceUUIDFromLocalStorage=function(){return this.tryGetDeviceUUIDFromLocalStorageByVarName(this.deviceUUIDVarName)},e.prototype.tryGetDeviceUUIDFromLocalStorageByVarName=function(e){try{return this._window.localStorage[e]}catch(e){return null}},e.prototype.provideNewDeviceUUID=function(){if(this.deviceUUIDCookieIsSet()||this.isUsingDeviceUUIDInLocalStorage())this.isDeviceUUIDCompletelySetOrSyncedResolve();else{var e=n.Guid.create().toString();this.setDeviceUUIDToLocalStorage(this.deviceUUIDVarName,e),this.migrationDeviceUUIDVarName&&this.isMigrationRequired&&this.setDeviceUUIDToLocalStorage(this.migrationDeviceUUIDVarName,e),this.isDeviceUUIDCompletelySetOrSyncedResolve()}},e.prototype.setDeviceUUID=function(e){this._cookieManager.removeAcrossBaseDomain(this.deviceUUIDVarName),this._cookieManager.set(this.deviceUUIDVarName,e,this._cookieManager.MaxCookieExpirationDate),this.setSession({deviceGuid:e}),this.setDeviceUUIDToLocalStorage(this.deviceUUIDVarName,e),this.migrationDeviceUUIDVarName&&this.isMigrationRequired&&this.setMigrationDeviceUUID(e),this.removeOldLocalStorage(),this.isDeviceUUIDCompletelySetOrSyncedResolve()},e.prototype.setMigrationDeviceUUID=function(e){this._cookieManager.removeAcrossBaseDomain(this.migrationDeviceUUIDVarName),this._cookieManager.set(this.migrationDeviceUUIDVarName,e,this._cookieManager.MaxCookieExpirationDate),this.setDeviceUUIDToLocalStorage(this.migrationDeviceUUIDVarName,e)},e.prototype.setDeviceUUIDToLocalStorage=function(e,t){try{this._window.localStorage[e]=t}catch(e){}},e.prototype.removeOldLocalStorage=function(){try{this._window.localStorage.removeItem(o)}catch(e){}},e.prototype.isUsingDeviceUUIDInLocalStorage=function(){var e=this.tryGetDeviceUUIDFromLocalStorageByVarName(this.deviceUUIDVarName);return Boolean(e)},e.prototype.deviceUUIDCookieIsSet=function(){var e=this._cookieManager.tryGet(this.deviceUUIDVarName);return Boolean(e)},e.prototype.isDeviceUUIDCompletelySet=function(){return this.deviceUUIDCookieIsSet()&&this.isUsingDeviceUUIDInLocalStorage()},e}();t.CustomerSessionStorage=i},6454:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultServiceDomain=t.getStaticAssetsDomain=t.targetModern=t.version=void 0,t.version="1.0.668",t.targetModern=!1;var r="api.mindbox.ru",n="web-static.mindbox.ru";t.getStaticAssetsDomain=function(){return-1!=n.indexOf("staticAssetsDomainDefinedByDeployment")?"web-static.mindbox.ru":n};t.getDefaultServiceDomain=function(){return-1!=r.indexOf("serviceDomainDefinedByDeployment")?"api.mindbox.ru":r}},9015:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpError=void 0;var r=function(e,t,r){this.statusCode=e,this.name="HttpError",this.message=t,this.requestId=r;try{throw new Error}catch(e){this.stack=e.stack}};t.HttpError=r},7095:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultipleCallsToCreateError=void 0;var r=function(e){if(this.stack=null,null==e)throw new Error("'settingsDiff' cannot be null");this.name="MultipleCallsToCreateError";var t=e.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join("; ");this.message="".concat("Multiple call for create. These settings are different from current",": ").concat(t)};t.MultipleCallsToCreateError=r},8850:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timeout=void 0;var r=function(e){this.name="Timeout",this.message=e;try{throw new Error}catch(e){this.stack=e.stack}};t.Timeout=r},4869:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultipleCallsToCreateError=t.Timeout=t.HttpError=void 0;var n=r(9015);Object.defineProperty(t,"HttpError",{enumerable:!0,get:function(){return n.HttpError}});var o=r(8850);Object.defineProperty(t,"Timeout",{enumerable:!0,get:function(){return o.Timeout}});var i=r(7095);Object.defineProperty(t,"MultipleCallsToCreateError",{enumerable:!0,get:function(){return i.MultipleCallsToCreateError}})},2573:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Feature=void 0,function(e){e.UseWebpushErrorLogging="useWebpushErrorLogging",e.UseWebpushFirebaseInitializationLogging="useWebpushFirebaseInitializationLogging"}(t.Feature||(t.Feature={}))},6540:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.helpersCommands=void 0;var n=r(3e3),o=r(5821),i=r(3969);t.helpersCommands={checkProductSegments:function(e){return(0,n.checkProductSegments)(e)},getDeviceUUID:function(e,t){return(0,o.getDeviceUUID)(e,t)},getEndpointId:i.getEndpointId}},9220:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheWithExpiry=void 0;var r=function(){function e(e,t,r){this.dateTimeMs=t,this.expiryMs=e,this.storage=r?JSON.parse(r):{},this.purge()}return e.prototype.purge=function(){var e=this.dateTimeMs();for(var t in this.storage){if(this.storage.hasOwnProperty(t))this.storage[t].expiry<e&&delete this.storage[t]}},e.prototype.get=function(e){var t=this.storage[e];if(t){if(!(t.expiry<this.dateTimeMs()))return t.value;delete this.storage[e]}},e.prototype.set=function(e,t){var r={expiry:this.dateTimeMs()+this.expiryMs,value:t};this.storage[e]=r},e.prototype.serialize=function(){return JSON.stringify(this.storage)},e}();t.CacheWithExpiry=r},3e3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkProductSegments=t.buildCompleteResponseFor=t.buildCompleteResponse=t.buildRequestDataFor=t.buildRequestData=t.toCacheKeyCollectionIdMap=t.getCacheKey=t.getSegmentationKey=t.getProductOrGroupKey=void 0;var n=r(9220);t.getProductOrGroupKey=function(e){return JSON.stringify(e.ids).toLowerCase()};t.getSegmentationKey=function(e){return e.ids.externalId.toLowerCase()};t.getCacheKey=function(e,r){return e+(0,t.getSegmentationKey)(r)};t.toCacheKeyCollectionIdMap=function(e,t){for(var r={},n=0;n<e.length;n++){r[t(e[n])]=n}return r};t.buildRequestData=function(e,r,n,o,i){var a={products:[],productGroups:[],segmentations:[]},s=[],u=[],c={},l={},d={},p={};if(null!=n&&n.length>0){var f=(0,t.buildRequestDataFor)(e,n,i,(function(e){return{product:e,segmentations:[]}}));a.products=f.requestProductsOrGroups,a.segmentations=f.requestSegmentations,s=f.responseFromCache,c=(0,t.toCacheKeyCollectionIdMap)(n,t.getProductOrGroupKey),p=f.requestedSegmentations}if(null!=o&&o.length>0){var h=(0,t.buildRequestDataFor)(r,o,i,(function(e){return{productGroup:e,segmentations:[]}}));a.productGroups=h.requestProductsOrGroups;for(var g=0;g<h.requestSegmentations.length;g++){var v=h.requestSegmentations[g];p[(0,t.getSegmentationKey)(v)]||a.segmentations.push(v)}u=h.responseFromCache,l=(0,t.toCacheKeyCollectionIdMap)(o,t.getProductOrGroupKey)}return null!=i&&i.length>0&&(d=(0,t.toCacheKeyCollectionIdMap)(i,t.getSegmentationKey)),{request:a,productResponseFromCache:s,productGroupResponseFromCache:u,productOrderMap:c,productGroupOrderMap:l,segmentationOrderMap:d}};t.buildRequestDataFor=function(e,r,n,o){for(var i=[],a=[],s=[],u={},c=0;c<r.length;c++){var l=r[c],d=(0,t.getProductOrGroupKey)(l);s[c]||(s[c]=o(l));for(var p=!1,f=0;f<n.length;f++){var h=n[f],g=(0,t.getSegmentationKey)(h),v=(0,t.getCacheKey)(d,h),m=e.get(v);void 0===m?(p=!0,u[g]||(a.push(h),u[g]=!0)):m&&(s[c].segmentations[f]={ids:h.ids,segment:m})}p&&i.push(l)}return{requestProductsOrGroups:i,requestSegmentations:a,responseFromCache:s,requestedSegmentations:u}};t.buildCompleteResponse=function(e,r,n,o){var i=[];i=(i=i.concat(n.productResponseFromCache)).concat(n.productGroupResponseFromCache),null!=o.products&&o.products.length>0&&(0,t.buildCompleteResponseFor)(e,n.productResponseFromCache,o.products,n.productOrderMap,n.segmentationOrderMap),null!=o.productGroups&&o.productGroups.length>0&&(0,t.buildCompleteResponseFor)(r,n.productGroupResponseFromCache,o.productGroups,n.productGroupOrderMap,n.segmentationOrderMap);for(var a=0;a<i.length;a++){for(var s=[],u=0;u<i[a].segmentations.length;u++){var c=i[a].segmentations[u];c&&s.push(c)}i[a].segmentations=s}return{productCache:e,productGroupCache:r,response:i}};t.buildCompleteResponseFor=function(e,r,n,o,i){for(var a=0;a<n.length;a++)for(var s=n[a],u=(0,t.getProductOrGroupKey)(s),c=r[o[u]],l=0;l<s.segmentations.length;l++){var d=s.segmentations[l],p=(0,t.getSegmentationKey)(d),f=(0,t.getCacheKey)(u,d);e.set(f,d.segment||null),c.segmentations[i[p]]=d.segment?d:void 0}};t.checkProductSegments=function(e){var r,o,i,a,s,u;if((null!==(a=null!==(o=null===(r=e.products)||void 0===r?void 0:r.length)&&void 0!==o?o:0+(null===(i=e.productGroups)||void 0===i?void 0:i.length))&&void 0!==a?a:0)>50)return Promise.reject(new Error("Too many products and product groups for a single call"));if(e.segmentations.length>10)return Promise.reject(new Error("Too many segmentations for a single call"));var c="MindboxProductSegmentsCache",l="MindboxProductGroupSegmentsCache",d=new n.CacheWithExpiry(3e5,Date.now,window.localStorage.getItem(c)),p=new n.CacheWithExpiry(3e5,Date.now,window.localStorage.getItem(l)),f=(0,t.buildRequestData)(d,p,e.products,e.productGroups,e.segmentations);if(0==(null===(s=f.request.products)||void 0===s?void 0:s.length)&&0==(null===(u=f.request.productGroups)||void 0===u?void 0:u.length)){var h=(0,t.buildCompleteResponse)(d,p,f,{products:[],productGroups:[]});return new Promise((function(t,r){e.onSuccess(h.response),t()}))}return new Promise((function(r,n){window.mindbox("sync",{operation:"Tracker.CheckProductSegments",data:f.request,onError:function(t){e.onError(t),n(t)},onSuccess:function(n){var o=(0,t.buildCompleteResponse)(d,p,f,n);window.localStorage.setItem(c,o.productCache.serialize()),window.localStorage.setItem(l,o.productGroupCache.serialize()),e.onSuccess(o.response),r()}})}))}},5821:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceUUID=void 0;t.getDeviceUUID=function(e,t){return t(e),Promise.resolve()}},3969:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEndpointId=void 0;t.getEndpointId=function(e,t){var r;return t(null!==(r=window.MindboxActualEndpointId)&&void 0!==r?r:e.endpointId),Promise.resolve()}},782:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MindboxTracker=void 0;var n=r(1635),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.initialize=function(){if(window.mindboxInitialized)throw new Error("Multiple attepmts to initialize tracker. Look for duplicate mindbox script-blocks.");var e;e=null!=window.mindbox&&null!=window.mindbox.queue?window.mindbox.queue:null!=window.directCrm&&null!=window.directCrm.Queue?window.directCrm.Queue:new Array,window.mindboxBatchedModulesQueue=new Array,window.mindboxBatchedModulesInitialized=!1;var r=new t(e,{deviceUUIDVarName:t.deviceUUIDVarName});window.mindbox=r.process,window.mindboxInitialized=!0,window.directCrm=r.process},t.dispose=function(){delete window.mindbox,delete window.mindboxInitialized,delete window.directCrm,delete window.mindboxBatchedModulesQueue,delete window.mindboxBatchedModulesInitialized,delete window.MindboxEndpointSettings,delete window.MindboxActualEndpointId},t.deviceUUIDVarName="mindboxDeviceUUID",t}(r(3829).Tracker);t.MindboxTracker=o},7486:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleManager=void 0;var n=r(1635),o=r(8397),i=r(6454),a=function(){function e(e){var t=e.trackerSettings,r=e.sessionStorage,n=e.deviceUUIDObtainingPromiseProvider,o=e.logger;if(this.loadingModulePromises={},this.previousCommandPromise=Promise.resolve(),this.isSupportedByBrowserCommand=function(e,t){return"isSupportedByBrowser"===e},null==t)throw new Error("'trackerSettings' cannot be null");if(null==r)throw new Error("'sessionStorage' cannot be null");if(null==n)throw new Error("'deviceUUIDObtainingPromiseProvider' cannot be null");if(null==o)throw new Error("'logger' cannot be null");this.trackerSettings=t,this.sessionStorage=r,this.deviceUUIDObtainingPromiseProvider=n,this.logger=o}return e.prototype.tryGetModuleCommand=function(e,t,r){return void 0===r&&(r={getModuleInfo:o.getModuleInfo,moduleExists:o.moduleExists}),n.__awaiter(this,void 0,Promise,(function(){var o,i,a,s,u,c;return n.__generator(this,(function(n){switch(n.label){case 0:return(o=e.indexOf("."))<=0?[2,null]:(i=e.substr(0,o),r.moduleExists(i)?(a=r.getModuleInfo(i),s=i,a.getModuleNameToReplace?[4,t]:[3,3]):[3,4]);case 1:return u=n.sent(),[4,a.getModuleNameToReplace(u)];case 2:s=n.sent(),n.label=3;case 3:return c=e.substr(o+1),[2,{moduleName:r.moduleExists(s)?s:i,command:c}];case 4:return[2,null]}}))}))},e.prototype.invokeModule=function(e,t){var r=this,n=e.moduleName,i=e.command;if(t instanceof Array&&t.length>1)throw new Error("[Mindbox.SDK] <".concat(n,"> Too many arguments for command."));var a=t instanceof Array?t[0]:t,s=(0,o.getModuleInfo)(n),u=s.isSupportedByBrowser();if(!s.requiresSdkInitialization()||window.mindboxBatchedModulesInitialized)if(this.isSupportedByBrowserCommand(i,a)){if(null==a||"function"!=typeof a.callback)throw new Error("[Mindbox.SDK] <".concat(n,'> Callback for command "isSupportedByBrowser" not set.'));a.callback(u)}else u&&this.moduleThen(n,(function(e){var t=e.commands&&e.commands[i]||e[i];return t?t(r.trackerSettings,r.sessionStorage.getDeviceUUID(),a):Promise.reject(new Error("[Mindbox.SDK] <".concat(n,'> Unknown command "').concat(i,'".')))}));else window.mindboxBatchedModulesQueue.push(["".concat(n,".").concat(i),a])},e.prototype.moduleThen=function(e,t){var r=this,a=this.deviceUUIDObtainingPromiseProvider();if(null==a)throw new Error("Previous request promise is expected to be set. 'mindbox(\"create\")' is expected to be called ahead of every other command");if(null==this.loadingModulePromises[e]){var s=new Promise((function(t,n){(0,o.loadModule)(r.trackerSettings,e,i.version,r.logger).then((function(e){return t(e)}),(function(e){return n(e)}))}));this.loadingModulePromises[e]=Promise.all([s,a]).then((function(e){return n.__awaiter(r,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return(null===(t=e[0].hooks)||void 0===t?void 0:t.onLoad)?[4,null===(r=e[0].hooks)||void 0===r?void 0:r.onLoad(this.trackerSettings)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2,e[0]]}}))}))}),(function(e){return Promise.reject(e)}))}this.loadingModulePromises[e].then((function(e){r.previousCommandPromise=r.previousCommandPromise.then((function(){return new Promise((function(n){t(e).then(n,(function(e){r.logger.logError(e),n()}))}))}))}),(function(e){return r.logger.logError(e)}))},e}();t.ModuleManager=a},1437:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleManager=void 0;var n=r(7486);Object.defineProperty(t,"ModuleManager",{enumerable:!0,get:function(){return n.ModuleManager}})},2744:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadSerializer=void 0;var r=function(){function e(){}return e.prototype.serialize=function(e,t){var r=[],n=!1;if("string"!=typeof e)for(var o in e)if(e.hasOwnProperty(o)){n=!0;var i=t?t+"."+o:o,a=e[o];if(Array.isArray(a))for(var s=0;s<a.length;s++)r.push(this.serialize(a[s],i+"["+s+"]"));else"object"==typeof a?r.push(this.serialize(a,i)):void 0!==a&&r.push(encodeURIComponent(i)+"="+encodeURIComponent(a))}return n||null==e||r.push(encodeURIComponent(t?t+"=":"")+encodeURIComponent(e)),r.filter((function(e){return e})).join("&")},e}();t.PayloadSerializer=new r},8151:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageCallbacksManagerSingleton=t.PageCallbacksManager=void 0;var n=r(4304),o=function(){function e(){this.onPageChangeCallbacks=new Array}return e.prototype.invokeOnPageChange=function(e){Promise.all(this.onPageChangeCallbacks.map((function(t){return t(e)}))).catch((function(e){return n.Logger.LogException(e)}))},e.prototype.registerOnPageChange=function(e){this.onPageChangeCallbacks.push(e)},e}();t.PageCallbacksManager=o,t.PageCallbacksManagerSingleton=new o},6069:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageDataRepositorySingleton=t.PageDataRepository=void 0;var r=function(){function e(){this.cartLocalStorageKey="mindbox_cart"}return e.prototype.savePageData=function(e){this.pageData=e},e.prototype.saveCart=function(e){localStorage.setItem(this.cartLocalStorageKey,JSON.stringify(e))},e.prototype.getPageData=function(){var e,t=JSON.parse(localStorage.getItem(this.cartLocalStorageKey));return null==this.pageData&&(this.pageData={type:"unknown",href:null==t?void 0:t.href,cart:[]}),this.pageData.cart=null!==(e=null==t?void 0:t.cart)&&void 0!==e?e:[],this.pageData},e}();t.PageDataRepository=r,t.PageDataRepositorySingleton=new r},2536:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.personalizationCommands=void 0;var n=r(6712),o=r(3150),i=r(6204),a=r(6765),s=r(8681),u=r(3587),c=new i.OnOperationCommandExecutor(a.viewProductExecutor,n.viewCategoryExecutor,u.setCartExecutor);t.personalizationCommands={onOperation:function(e,t){return c.onOperation(e,t)},registerOnPageChangeCallback:s.registerOnPageChangeCallback,invokeWithPageData:o.invokeWithPageData,viewCategory:n.viewCategory,viewProduct:a.viewProduct,setCart:u.setCart}},6204:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OnOperationCommandExecutor=void 0;var n=r(1635),o=function(){function e(e,t,r){this.viewProductExecutor=e,this.viewCategoryExecutor=t,this.setCartExecutor=r}return e.prototype.onOperation=function(e,t){var r,o,i,a,s,u;return n.__awaiter(this,void 0,Promise,(function(){var c,l,d,p;return n.__generator(this,(function(n){switch(n.label){case 0:if(null==(null==e?void 0:e.endpointSettings)||null==(null==t?void 0:t.operation)||""==(null==t?void 0:t.operation)||null==(null==t?void 0:t.data))return[2];switch(c=null!==(o=null===(r=e.endpointSettings.viewProductOperationSystemName)||void 0===r?void 0:r.toLowerCase())&&void 0!==o?o:"",l=null!==(a=null===(i=e.endpointSettings.viewCategoryOperationSystemName)||void 0===i?void 0:i.toLowerCase())&&void 0!==a?a:"",d=null!==(u=null===(s=e.endpointSettings.setCartOperationSystemName)||void 0===s?void 0:s.toLowerCase())&&void 0!==u?u:"",p=t.operation.toLowerCase(),p){case c:return[3,1];case l:return[3,3];case d:return[3,5]}return[3,7];case 1:return[4,this.viewProductExecutor.execute(t.data)];case 2:case 4:case 6:return n.sent(),[3,8];case 3:return[4,this.viewCategoryExecutor.execute(t.data)];case 5:return[4,this.setCartExecutor.execute(t.data)];case 7:return[3,8];case 8:return[2]}}))}))},e}();t.OnOperationCommandExecutor=o},8591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetCartExecutor=void 0;var n=r(1635),o=function(){function e(e,t,r){this.pageDataRepository=e,this.pageCallbacksManager=t,this.hrefResolver=r}return e.prototype.execute=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r;return n.__generator(this,(function(n){return null==(null==e?void 0:e.productList)||(t={type:"unknown",href:this.hrefResolver(),cart:e.productList},this.pageDataRepository.saveCart(t),r=this.pageDataRepository.getPageData(),this.pageCallbacksManager.invokeOnPageChange(r)),[2]}))}))},e}();t.SetCartExecutor=o},5174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewCategoryExecutor=void 0;var n=r(1635),o=function(){function e(e,t,r){this.pageDataRepository=e,this.pageCallbacksManager=t,this.hrefResolver=r}return e.prototype.execute=function(e){var t,r;return n.__awaiter(this,void 0,Promise,(function(){var o,i;return n.__generator(this,(function(n){return null==(null===(r=null===(t=null==e?void 0:e.viewProductCategory)||void 0===t?void 0:t.productCategory)||void 0===r?void 0:r.ids)||(o={type:"category",href:this.hrefResolver(),category:e.viewProductCategory.productCategory,cart:[]},this.pageDataRepository.savePageData(o),i=this.pageDataRepository.getPageData(),this.pageCallbacksManager.invokeOnPageChange(i)),[2]}))}))},e}();t.ViewCategoryExecutor=o},8333:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewProductExecutor=void 0;var n=r(1635),o=function(){function e(e,t,r){this.pageDataRepository=e,this.pageCallbacksManager=t,this.hrefResolver=r}return e.prototype.execute=function(e){var t,r,o,i,a,s;return n.__awaiter(this,void 0,Promise,(function(){var u,c;return n.__generator(this,(function(n){return null==(null===(r=null===(t=null==e?void 0:e.viewProduct)||void 0===t?void 0:t.product)||void 0===r?void 0:r.ids)&&null==(null===(i=null===(o=null==e?void 0:e.viewProduct)||void 0===o?void 0:o.productGroup)||void 0===i?void 0:i.ids)||(u={type:"product",href:this.hrefResolver(),product:null===(a=null==e?void 0:e.viewProduct)||void 0===a?void 0:a.product,productGroup:null===(s=null==e?void 0:e.viewProduct)||void 0===s?void 0:s.productGroup,cart:[]},this.pageDataRepository.savePageData(u),c=this.pageDataRepository.getPageData(),this.pageCallbacksManager.invokeOnPageChange(c)),[2]}))}))},e}();t.ViewProductExecutor=o},3150:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invokeWithPageData=void 0;var n=r(1635),o=r(6069);t.invokeWithPageData=function(e){return n.__awaiter(void 0,void 0,Promise,(function(){return n.__generator(this,(function(t){return e(o.PageDataRepositorySingleton.getPageData()),[2]}))}))}},8681:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerOnPageChangeCallback=void 0;var n=r(1635),o=r(8151);t.registerOnPageChangeCallback=function(e){return n.__awaiter(void 0,void 0,Promise,(function(){return n.__generator(this,(function(t){return o.PageCallbacksManagerSingleton.registerOnPageChange(e),[2]}))}))}},3587:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCart=t.setCartExecutor=void 0;var n=r(1635),o=r(8151),i=r(6069),a=r(8591);t.setCartExecutor=new a.SetCartExecutor(i.PageDataRepositorySingleton,o.PageCallbacksManagerSingleton,(function(){return window.location.href}));t.setCart=function(e){return n.__awaiter(void 0,void 0,Promise,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return null==(null==e?void 0:e.data)?[3,2]:[4,t.setCartExecutor.execute(e.data)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}},6712:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viewCategory=t.viewCategoryExecutor=void 0;var n=r(1635),o=r(8151),i=r(6069),a=r(5174);t.viewCategoryExecutor=new a.ViewCategoryExecutor(i.PageDataRepositorySingleton,o.PageCallbacksManagerSingleton,(function(){return window.location.href}));t.viewCategory=function(e){return n.__awaiter(void 0,void 0,Promise,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return null==(null==e?void 0:e.data)?[3,2]:[4,t.viewCategoryExecutor.execute(e.data)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}},6765:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viewProduct=t.viewProductExecutor=void 0;var n=r(1635),o=r(8151),i=r(6069),a=r(8333);t.viewProductExecutor=new a.ViewProductExecutor(i.PageDataRepositorySingleton,o.PageCallbacksManagerSingleton,(function(){return window.location.href}));t.viewProduct=function(e){return n.__awaiter(void 0,void 0,Promise,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return null==(null==e?void 0:e.data)?[3,2]:[4,t.viewProductExecutor.execute(e.data)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}},154:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iterateQueue=void 0;t.iterateQueue=function(e,t){if(null!=e)for(var r=0;r<e.length;++r){t(Array.prototype.slice.call(e[r]),r)}}},9929:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestSender=void 0;var n=r(8054),o=r(6454),i=r(3129),a=function(){function e(e,t,r,o,i){this._sessionStorage=e,this._serviceDomain=t,this._projectDomain=r,this._useHttp=o||!1,this._crossDomainRequestFactory=i||n.CrossDomainRequestFactory}return e.prototype.getProtocol=function(){return this._useHttp?"http://":"https://"},e.prototype.sendToTrackerAndForget=function(e,t,r,n){var o=this,a=this.createCrossDomainRequest(i.HttpMethods.POST,this._serviceDomain+e,t,r,n);return this._sessionStorage.isDeviceUUIDCompletelySet()?a.sendAndForget():a.sendAndGetResult().then((function(e){return o.processResponse(e)}),(function(e){return o.processFailure(e)}))},e.prototype.sendToTrackerAndGetResult=function(e,t,r,n){var o=this;return this.createCrossDomainRequest(i.HttpMethods.POST,this._serviceDomain+e,t,r,n).sendAndGetResult().then((function(e){return o.processResponse(e),e}),(function(e){return o.processFailure(e)}))},e.prototype.sendToTrackerWithoutSessionAndGetResult=function(e,t){return this.createCrossDomainRequest(i.HttpMethods.POST,this._serviceDomain+e,t).sendAndGetResult()},e.prototype.createCrossDomainRequest=function(e,t,r,n,i){return t=this.getProtocol()+t+(t.match(/\?/)?"&":"?")+"version="+o.version,n&&n.length>0&&(t+="&"+n.map((function(e){return e.name+"="+e.value})).join("&")),this._crossDomainRequestFactory(e,t,r,i)},e.prototype.sendToDirectCrm=function(e,t){if(!this._projectDomain)throw new Error("You should initialize tracker with projectDomain property.");var r={deviceGuid:this._sessionStorage.tryGetDeviceUUID()};return t.customerSession=encodeURIComponent(JSON.stringify(r)),t.deviceUUID=this._sessionStorage.tryGetDeviceUUID(),this.createCrossDomainRequest(i.HttpMethods.GET,this._projectDomain+e,t).sendAndGetResult()},e.prototype.processResponse=function(e){if(!e.deviceUUID)throw this._sessionStorage.provideNewDeviceUUID(),new Error("Incorrect server response: ".concat(JSON.stringify(e)));this._sessionStorage.setDeviceUUID(e.deviceUUID)},e.prototype.processFailure=function(e){throw this._sessionStorage.provideNewDeviceUUID(),e},e}();t.RequestSender=a},3908:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IanaTimeZoneProvider=void 0;var r=function(){function e(){}return e.prototype.tryGetTimeZone=function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return null}},e}();t.IanaTimeZoneProvider=r},3829:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var n=r(1635);r(1421);var o=r(6454),i=r(6454),a=r(9929),s=r(4869),u=r(9204),c=r(5980),l=r(9986),d=r(6e3),p=r(1437),f=r(6540),h=r(2536),g=r(4846),v=r(3908);r(2573);var m=r(7095),y=r(4304),w=r(666),_=r(7732),b=r(154),D=function(){function e(e,t){var r=t.deviceUUIDVarName,f=t.migrationDeviceUUIDVarName,h=t.isMigrationRequired,g=void 0!==h&&h,w=this;this._previousRequestPromise=null,this.createRequestsCounter=0,this.endpointSettingsFetching={promise:Promise.resolve(null),resolve:function(){}},this.process=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Array.prototype.slice.call(e);w.invoke(r.shift(),r)},this.isPrerenderOrPreview=function(){var e=w._window.document.visibilityState||w._window.document.webkitVisibilityState||"visible";return"preview"==e||"prerender"==e},this.invoke=function(e,t){return n.__awaiter(w,void 0,void 0,(function(){var r,o,i,a=this;return n.__generator(this,(function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),!e)throw new Error("methodName required");if("create"!==e&&!this._settings)throw new Error('You should call "create" first');return"create"===e||this._cookieManager.isCookieEnabled()&&!this.isPrerenderOrPreview()?"create"===e?(this.tryCreate(t[0]),[2]):"getDiagnosticsInfo"===e&&t[0]instanceof Function?(this.getDiagnosticsInfo(t[0]),[2]):[4,this.moduleManager.tryGetModuleCommand(e,this.endpointSettingsFetching.promise)]:[2];case 1:if(null!=(r=n.sent()))return this.moduleManager.invokeModule(r,t),[2];if(void 0===this[o=e.replace(".","_")])throw new Error("Unknown method: "+o);return t instanceof Array?this.then((function(){return a[o].apply(a,t)})):this.then((function(){return a[o].call(a,t)})),[3,3];case 2:return i=n.sent(),this.logErrorWithDataFromTracker(i),[3,3];case 3:return[2]}}))}))},this.then=function(e){w._sessionStorage.deviceUUIDCookieIsSet()?e().then(void 0,(function(e){return w.logErrorWithDataFromTracker(e)})):null==w._previousRequestPromise?w._previousRequestPromise=e().then(void 0,(function(e){return w.logErrorWithDataFromTracker(e)})):w._previousRequestPromise=w._previousRequestPromise.then((function(){return e()})).then(void 0,(function(e){return w.logErrorWithDataFromTracker(e)}))},this.getTrackerAdditionalData=function(){var e=null;try{e=w._sessionStorage.tryGetDeviceUUID()}catch(e){}return{Version:o.version,"Point of contact":w._settings.pointOfContactSystemName,Endpoint:w._settings.endpointId,Origin:location.origin,DeviceUUID:e}},this.logErrorWithDataFromTracker=function(e,t){if(!w._settings)throw new Error("Tracker not initialized. "+e);var r=w.getTrackerAdditionalData(),o=e;o.requestId&&(r.RequestId=o.requestId),w._logger.logError(e,n.__assign(n.__assign({},r),t))},this.trackEventWithDataFromTracker=function(e,t){var r=w.getTrackerAdditionalData();w._logger.trackEvent(e,n.__assign(n.__assign({},r),t))},this.getDiagnosticsInfo=function(e){e({createRequestsCount:w.createRequestsCounter,endpointId:null!=w._settings?w._settings.endpointId:null})},this.tryCreate=function(e){if(++w.createRequestsCounter,!w._previousRequestPromise)return w.create(e),void w.loadEndpointSettings();var t=(0,d.compareSettings)(w._settings,e);null!=t&&w.logErrorWithDataFromTracker(new m.MultipleCallsToCreateError(t))},this.create=function(e){w._settings=e||{},null==w._settings.serviceDomain||"tracker.directcrm.ru"===w._settings.serviceDomain?w._settings.serviceDomain=(0,i.getDefaultServiceDomain)():"tracker.staging.directcrm.ru"===w._settings.serviceDomain&&(w._settings.serviceDomain="api-staging.mindbox.ru"),null==w._settings.staticAssetsDomain&&(w._settings.staticAssetsDomain=(0,o.getStaticAssetsDomain)()),w._window=w._settings.windowOverride?w._settings.windowOverride:window,w._logger=null==w._settings.loggerOverride?new l.TrackerLogger:w._settings.loggerOverride,w._jsModulesClient=w._settings.jsModulesClientOverride||_.jsModulesClient,w._cookieManager=new u.Manager(w._window),w._cookieManager.setBaseDomain(),w._sessionStorage=new c.CustomerSessionStorage({cookieManager:w._cookieManager,windowOverride:w._window,deviceUUIDVarName:w.deviceUUIDVarName,migrationDeviceUUIDVarName:w.migrationDeviceUUIDVarName,isMigrationRequired:w._settings.hasOwnProperty("isMigrationRequired")?w._settings.isMigrationRequired:w.isMigrationRequired,logger:w._logger}),w._sender=new a.RequestSender(w._sessionStorage,w._settings.serviceDomain,w._settings.projectDomain,w._settings.useHttp,w._settings.crossDomainRequestFactoryOverride),w.timeZoneProvider=null==w._settings.timeZoneProviderOverride?new v.IanaTimeZoneProvider:w._settings.timeZoneProviderOverride;var t={logError:w.logErrorWithDataFromTracker,trackEvent:w.trackEventWithDataFromTracker},r=w._settings.ModuleManagerOverride||p.ModuleManager;if(w.moduleManager=new r({trackerSettings:w._settings,sessionStorage:w._sessionStorage,deviceUUIDObtainingPromiseProvider:function(){return w._previousRequestPromise},logger:t}),w._cookieManager.isCookieEnabled()&&!w.isPrerenderOrPreview()){var n=null!=w._window.location.search&&-1!==w._window.location.search.indexOf("s=");if(w._previousRequestPromise=(n?w.attemptRedirect():w.trackVisit()).then(void 0,(function(e){return w.logErrorWithDataFromTracker(e)})),w._settings.keepAlive)var d=setInterval((function(){w._previousRequestPromise=w._previousRequestPromise.then((function(){return w.keepAlive()})).then(void 0,(function(e){e&&e instanceof s.Timeout||clearInterval(d),w.logErrorWithDataFromTracker(e)}))}),3e5)}},this.attemptRedirect=function(){var e={options:{pointOfContactSystemName:w._settings.pointOfContactSystemName},originDomain:w._window.document.location.host,requestUrl:w._window.document.location.href};return null!=w._settings.endpointId&&(e.endpointId=w._settings.endpointId),w._sender.sendToTrackerWithoutSessionAndGetResult("/v1.1/redirect",e).then((function(e){null!=e.redirectUrl?w._window.location.replace(e.redirectUrl):w.trackVisit()}))},this.validateOperationParameters=function(e){if(!e)throw new Error("parameters required");if(!e.operation)throw new Error("operation required")},this.createV3Request=function(e){var t={originDomain:w._window.location.host,deviceUUID:w._sessionStorage.tryGetDeviceUUID(),operation:e.operation,ianaTimeZone:w.timeZoneProvider.tryGetTimeZone()};return null!=w._settings.endpointId&&(t.endpointId=w._settings.endpointId),e.data&&(t.data=JSON.stringify(e.data)),{request:t,additionalParameters:Object.keys(e).filter((function(e){return"operation"!=e&&"data"!=e&&"onSuccess"!=e&&"onValidationError"!=e&&"onError"!=e})).map((function(t){return{name:t,value:e[t]}}))}},this.fillMessageData=function(e){var t=w._sessionStorage.tryGetDeviceUUID();if(null!=t&&""!=t)if("undefined"!=t)e.session={deviceGuid:t};else{w.logErrorWithDataFromTracker(new Error("deviceUUID = ".concat(t))),w._cookieManager.remove(w.deviceUUIDVarName),w._cookieManager.remove("directCrm-session");try{w._window.localStorage.removeItem("directCrm-session")}catch(e){}}e.options={pointOfContactSystemName:w._settings.pointOfContactSystemName},null!=w._settings.endpointId&&(e.endpointId=w._settings.endpointId),e.originDomain=w._window.document.location.host;try{e.screenResolution=window.screen.width+"x"+window.screen.height}catch(e){}},this.onOperationHook=function(e){var t,r,n;try{if(null==w._settings)return;var o=null!=(null===(t=w._settings.endpointSettings)||void 0===t?void 0:t.viewProductOperationSystemName)||null!=(null===(r=w._settings.endpointSettings)||void 0===r?void 0:r.viewCategoryOperationSystemName)||null!=(null===(n=w._settings.endpointSettings)||void 0===n?void 0:n.setCartOperationSystemName);if(window.mindboxBatchedModulesInitialized&&!o)return;w.invoke("personalization.onOperation",e)}catch(e){y.Logger.LogException(e)}};try{this.deviceUUIDVarName=r,this.migrationDeviceUUIDVarName=f,this._jsModulesClient=_.jsModulesClient,this._previousRequestPromise=void 0,this.endpointSettingsFetching.promise=new Promise((function(e){w.endpointSettingsFetching.resolve=e})),this.isMigrationRequired=g,(0,b.iterateQueue)(e,(function(t,r){"create"==t[0]&&(w.invoke(t.shift(),t),e.splice(r,1))})),(0,b.iterateQueue)(e,(function(e,t){return w.invoke(e.shift(),e)}))}catch(e){this.logErrorWithDataFromTracker(e)}}return e.prototype.loadEndpointSettings=function(){var e=this;new w.BatchedModulesLoader(this._jsModulesClient).loadModule(this._settings,this._window.location.host).then((function(t){e._settings.endpointSettings=e._window.MindboxEndpointSettings,e.endpointSettingsFetching.resolve(e._settings.endpointSettings),e.resolveSdkInitQueue()}),(function(e){window.mindboxBatchedModulesInitialized=!0}))},e.prototype.resolveSdkInitQueue=function(){var e=this;if(1!=window.mindboxBatchedModulesInitialized){window.mindboxBatchedModulesInitialized=!0;try{(0,b.iterateQueue)(window.mindboxBatchedModulesQueue,(function(t,r){return e.invoke(t.shift(),t)}))}catch(e){this._logger.logError(e)}}},e.prototype.trackVisit=function(){var e={requestUrl:this._window.document.location.href,referrerUrl:this._window.document.referrer,ianaTimeZone:this.timeZoneProvider.tryGetTimeZone()};return this._settings.redirectedFrom&&(this._settings.redirectedFrom.requestUrl||this._settings.redirectedFrom.referrerUrl)&&(e.redirectedFrom={requestUrl:this._settings.redirectedFrom.requestUrl,referrerUrl:this._settings.redirectedFrom.referrerUrl}),this.fillMessageData(e),this._sender.sendToTrackerAndForget("/v1.1/customer/track-visit",e)},e.prototype.keepAlive=function(){var e={};return this.fillMessageData(e),this._sender.sendToTrackerAndForget("/v1.1/customer/keep-alive",e)},e.prototype.sync=function(e){var t=this;if(this.validateOperationParameters(e),e.onSuccess&&"function"!=typeof e.onSuccess)throw new Error("onSuccess should be a function");if(e.onValidationError&&"function"!=typeof e.onValidationError)throw new Error("onValidationError should be a function");if(e.onError&&"function"!=typeof e.onError)throw new Error("onError should be a function");this.onOperationHook(e);var r=this.createV3Request(e),o=r.request,i=r.additionalParameters,a={operation:o.operation,endpointId:o.endpointId,originDomain:o.originDomain},s=function(r){e.onError&&e.onError(r),t.logErrorWithDataFromTracker(r)};return this._sender.sendToTrackerAndGetResult("/v3/js/operations/sync",o,i,a).then((function(t){if(g.ServiceResponses.isSuccess(t)){if(e.onSuccess){var r=n.__assign({},t);delete r.deviceUUID,delete r.requestId,delete r.status,e.onSuccess(r)}}else if(g.ServiceResponses.isValidationError(t))if(e.onValidationError)e.onValidationError(t.validationMessages);else{var o={name:"Unhandled validation error",message:JSON.stringify(t.validationMessages),requestId:t.requestId};s(o)}else s({name:"Malformed server response",message:JSON.stringify(t)})}),s)},e.prototype.async=function(e){var t=this;if(this.validateOperationParameters(e),e.onSuccess&&"function"!=typeof e.onSuccess)throw new Error("onSuccess should be a function");if(e.onError&&"function"!=typeof e.onError)throw new Error("onError should be a function");this.onOperationHook(e);var r=this.createV3Request(e),n=r.request,o=r.additionalParameters,i={operation:n.operation,endpointId:n.endpointId,originDomain:n.originDomain};return this._sender.sendToTrackerAndForget("/v3/js/operations/async",n,o,i).then((function(){e.onSuccess&&e.onSuccess()}),(function(r){e.onError&&e.onError(r),t.logErrorWithDataFromTracker(r)}))},e.prototype.helpers_getEndpointId=function(e){var t=this;return this.endpointSettingsFetching.promise.then((function(){return f.helpersCommands.getEndpointId(t._settings,e)}))},e.prototype.helpers_getDeviceUUID=function(e){var t=this;return this._sessionStorage.isDeviceUUIDCompletelySetOrSynced.then((function(){return f.helpersCommands.getDeviceUUID(t._sessionStorage.getDeviceUUID(),e)}))},e.prototype.helpers_checkProductSegments=function(e){return f.helpersCommands.checkProductSegments(e)},e.prototype.personalization_onOperation=function(e){var t=this;return this.endpointSettingsFetching.promise.then((function(){return h.personalizationCommands.onOperation(t._settings,e)}))},e.prototype.personalization_registerOnPageChangeCallback=function(e){return h.personalizationCommands.registerOnPageChangeCallback(e)},e.prototype.personalization_invokeWithPageData=function(e){return h.personalizationCommands.invokeWithPageData(e)},e.prototype.personalization_viewCategory=function(e){return h.personalizationCommands.viewCategory(e)},e.prototype.personalization_viewProduct=function(e){return h.personalizationCommands.viewProduct(e)},e.prototype.personalization_setCart=function(e){return h.personalizationCommands.setCart(e)},e.prototype.authenticate=function(e){var t={ticket:e};return this.fillMessageData(t),this._sender.sendToTrackerAndForget("/v1.1/customer/authenticate/by-ticket",t)},e.prototype.identify=function(e){var t=this;if(!e)throw new Error("parameters required");if(!e.operation)throw new Error("operation required");if(!e.identificator)throw new Error("identificator required");if(!e.identificator.provider)throw new Error("provider required");if(!e.identificator.identity)throw new Error("identity required");var r={operation:e.operation,identity:e.identificator.identity,provider:e.identificator.provider,ianaTimeZone:this.timeZoneProvider.tryGetTimeZone()};e.data&&(r.data=JSON.stringify(e.data)),this.fillMessageData(r);var n=e.success&&"function"==typeof e.success?e.success:function(){},o=e.error&&"function"==typeof e.error?e.error:function(e){};return this._sender.sendToTrackerAndForget("/v1.1/customer/identify",r).then(n,(function(e){o(e),t.logErrorWithDataFromTracker(e)}))},e.prototype.performOperation=function(e){var t=this;if(!e)throw new Error("parameters required");var r=e.success&&"function"==typeof e.success?e.success:function(){},n=e.error&&"function"==typeof e.error?e.error:function(e){},o={operationSystemName:"string"==typeof e?e:e.operation};return this.fillMessageData(o),e.data&&(o.data=JSON.stringify(e.data)),this._sender.sendToTrackerAndForget("/v1.1/customer/track-event",o).then(r,(function(e){n(e),t.logErrorWithDataFromTracker(e)}))},e.prototype.closeSession=function(){var e={};return this.fillMessageData(e),this._sender.sendToTrackerAndForget("/v1.1/customer/close-session",e)},e.prototype.order_create=function(e){var t={order:e};return this.fillMessageData(t),this._sender.sendToTrackerAndForget("/v1.1/order/create",t)},e.prototype.cart_addProduct=function(e){var t={item:e};return this.fillMessageData(t),this._sender.sendToTrackerAndForget("/v1.1/cart/add-product",t)},e.prototype.cart_removeProduct=function(e){var t={item:e};return this.fillMessageData(t),this._sender.sendToTrackerAndForget("/v1.1/cart/remove-product",t)},e.prototype.cart_setProductQuantity=function(e){var t={item:e};return this.fillMessageData(t),this._sender.sendToTrackerAndForget("/v1.1/cart/set-product-quantity",t)},e.prototype.cart_clear=function(){var e={};return this.fillMessageData(e),this._sender.sendToTrackerAndForget("/v1.1/cart/clear",e)},e}();t.Tracker=D},9986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerLogger=void 0;var n=r(1635).__importStar(r(4869)),o=r(1616),i=function(){function e(){this.logger=new o.LoggerStub}return e.prototype.logError=function(e,t){if(console.error(e),e instanceof n.Timeout)this.logger.trackEvent("Timeout",t);else if(e instanceof n.HttpError){400!==e.statusCode&&401!==e.statusCode&&403!==e.statusCode&&this.logger.trackException(e)}else{if(e instanceof n.MultipleCallsToCreateError)return;this.logger.trackException(e)}},e.prototype.trackEvent=function(e,t){this.logger.trackEvent(e,t)},e}();t.TrackerLogger=i},6e3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareSettings=t.getScriptsRoot=t.getStaticAssetsRoot=t.getEffectiveApiUri=void 0;var n=r(1635);t.compareSettings=function(e,t){var r,i,a=new Array;try{for(var s=n.__values(Object.keys(e)),u=s.next();!u.done;u=s.next()){var c=u.value,l=o(c,e,t);null!=l&&a.push(l)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return 0===a.length?null:a};var o=function(e,t,r){var n;switch(e){case"serviceDomain":case"staticAssetsDomain":n=null;break;case"redirectedFrom":n=i(t[e],r[e])?null:"redirectedFrom objects are different";break;default:n=t[e]===r[e]?null:"".concat(t[e]," !== ").concat(r[e])}return null==n?null:{key:e,message:n}},i=function(e,t){return e.requestUrl===t.requestUrl&&e.referrerUrl===t.referrerUrl},a=function(e){if(null==e)throw new Error("'settings' cannot be null");var t=e.useHttp?"http":"https",r=null!=e.serviceDomain?e.serviceDomain:"api.mindbox.ru";return"".concat(t,"://").concat(r)};t.getEffectiveApiUri=a;t.getStaticAssetsRoot=function(e){if(null==e)throw new Error("'settings' cannot be null");var t=e.useHttp?"http":"https",r=null!=e.staticAssetsDomain?e.staticAssetsDomain:"web-static.mindbox.ru";return"".concat(t,"://").concat(r)};t.getScriptsRoot=function(e){return a(e)}},1635:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return T},__assign:function(){return i},__asyncDelegator:function(){return E},__asyncGenerator:function(){return P},__asyncValues:function(){return M},__await:function(){return S},__awaiter:function(){return h},__classPrivateFieldGet:function(){return O},__classPrivateFieldIn:function(){return x},__classPrivateFieldSet:function(){return R},__createBinding:function(){return v},__decorate:function(){return s},__disposeResources:function(){return q},__esDecorate:function(){return c},__exportStar:function(){return m},__extends:function(){return o},__generator:function(){return g},__importDefault:function(){return I},__importStar:function(){return k},__makeTemplateObject:function(){return C},__metadata:function(){return f},__param:function(){return u},__propKey:function(){return d},__read:function(){return w},__rest:function(){return a},__runInitializers:function(){return l},__setFunctionName:function(){return p},__spread:function(){return _},__spreadArray:function(){return D},__spreadArrays:function(){return b},__values:function(){return y}});
/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),p=!1,f=r.length-1;f>=0;f--){var h={};for(var g in n)h[g]="access"===g?{}:n[g];for(var g in n.access)h.access[g]=n.access[g];h.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var v=(0,r[f])("accessor"===u?{get:d.get,set:d.set}:d[c],h);if("accessor"===u){if(void 0===v)continue;if(null===v||"object"!=typeof v)throw new TypeError("Object expected");(s=a(v.get))&&(d.get=s),(s=a(v.set))&&(d.set=s),(s=a(v.init))&&o.unshift(s)}else(s=a(v))&&("field"===u?o.unshift(s):d[c]=s)}l&&Object.defineProperty(l,n.name,d),p=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function g(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var v=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function m(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||v(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function D(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof S?Promise.resolve(r.value.v).then(u,c):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function E(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:o?o(t):t}:o}}function M(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var U=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&v(t,e,r);return U(t,e),t}function I(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function R(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function T(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var j="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function q(e){function t(t){e.error=e.hasError?new j(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}t.default={__extends:o,__assign:i,__rest:a,__decorate:s,__param:u,__metadata:f,__awaiter:h,__generator:g,__createBinding:v,__exportStar:m,__values:y,__read:w,__spread:_,__spreadArrays:b,__spreadArray:D,__await:S,__asyncGenerator:P,__asyncDelegator:E,__asyncValues:M,__makeTemplateObject:C,__importStar:k,__importDefault:I,__classPrivateFieldGet:O,__classPrivateFieldSet:R,__classPrivateFieldIn:x,__addDisposableResource:T,__disposeResources:q}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};!function(){"use strict";r(782).MindboxTracker.initialize()}()}();